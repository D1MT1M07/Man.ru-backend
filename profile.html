<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å - Man.ru. –í–∞—à –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —Å –∏—Å—Ç–æ—Ä–∏–µ–π —Å—Ç–∞—Ç–µ–π, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π.">
    <title>–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å - Man.ru</title>
    <link rel="stylesheet" href="modern.css">
    <link rel="stylesheet" href="profile.css">
    <style>
        .profile-header {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.8), rgba(15, 23, 42, 0.8));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 16px;
            padding: 40px;
            margin-bottom: 30px;
            display: grid;
            grid-template-columns: 180px 1fr;
            gap: 40px;
            align-items: start;
        }

        .profile-avatar {
            text-align: center;
        }

        .avatar-circle {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background: linear-gradient(135deg, #6366f1, #06b6d4);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 80px;
            margin-bottom: 16px;
            box-shadow: 0 8px 32px rgba(99, 102, 241, 0.3);
        }

        .profile-info h1 {
            font-size: 28px;
            color: var(--text-primary);
            margin-bottom: 8px;
            font-weight: 700;
        }

        .profile-info p {
            color: var(--text-secondary);
            font-size: 15px;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-top: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(236, 72, 153, 0.05));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(99, 102, 241, 0.2);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            border-color: rgba(99, 102, 241, 0.4);
            box-shadow: 0 8px 20px rgba(99, 102, 241, 0.15);
        }

        .stat-card__number {
            font-size: 24px;
            font-weight: 800;
            background: linear-gradient(135deg, #06b6d4, #6366f1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-card__label {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 8px;
            font-weight: 600;
        }

        .section-content {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
            margin-bottom: 40px;
        }

        .content-item {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.7), rgba(15, 23, 42, 0.7));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .content-item:hover {
            transform: translateY(-5px);
            border-color: rgba(99, 102, 241, 0.2);
            box-shadow: 0 12px 40px rgba(99, 102, 241, 0.15);
        }

        .content-item__title {
            font-size: 15px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .content-item__category {
            display: inline-block;
            font-size: 11px;
            color: var(--accent-color);
            text-transform: uppercase;
            margin-bottom: 10px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .content-item__excerpt {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 10px;
            line-height: 1.5;
        }

        .content-item__meta {
            font-size: 12px;
            color: var(--text-secondary);
            display: flex;
            justify-content: space-between;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid rgba(148, 163, 184, 0.1);
        }

        .btn-delete {
            background: transparent;
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
            padding: 5px 10px;
            border-radius: 6px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .btn-delete:hover {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.5);
        }

        .profile-section {
            margin-bottom: 50px;
        }

        .profile-section__title {
            font-size: 18px;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 25px;
            text-transform: uppercase;
            letter-spacing: 1px;
            background: linear-gradient(90deg, #06b6d4, #6366f1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .empty-state {
            text-align: center;
            padding: 60px 40px;
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.5), rgba(15, 23, 42, 0.5));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 12px;
            color: var(--text-secondary);
        }

        .empty-state__icon {
            font-size: 48px;
            margin-bottom: 16px;
        }

        .empty-state__text {
            font-size: 15px;
            color: var(--text-secondary);
        }

        @media (max-width: 1024px) {
            .section-content {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .profile-header {
                grid-template-columns: 1fr;
                text-align: center;
            }
        }

        @media (max-width: 768px) {
            .profile-header {
                grid-template-columns: 1fr;
                text-align: center;
                gap: 20px;
            }

            .profile-stats {
                grid-template-columns: repeat(2, 1fr);
            }

            .section-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header__top">
            <div class="header__container">
                <div class="header__logo">
                    <h1><a href="index.html" style="text-decoration: none;">Man.ru</a></h1>
                    <div class="header__tagline">–°—Ç–∏–ª—å. –£—Å–ø–µ—Ö. –ì–∞—Ä–º–æ–Ω–∏—è</div>
                </div>
                <div class="header__search">
                    <input type="text" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Å–∞–π—Ç—É..." class="header__search-input">
                    <button class="header__search-btn">üîç</button>
                </div>
                <div class="header__auth" id="authContainer">
                    <!-- Auth button will be inserted here -->
                </div>
            </div>
        </div>
        
        <nav class="header__nav">
            <div class="header__container">
                <ul class="nav__list">
                    <li><a href="health.html" class="nav__link">‚ù§Ô∏è –ó–¥–æ—Ä–æ–≤—å–µ</a></li>
                    <li><a href="fitness.html" class="nav__link">üí™ –§–∏—Ç–Ω–µ—Å</a></li>
                    <li><a href="career.html" class="nav__link">üíº –ö–∞—Ä—å–µ—Ä–∞</a></li>
                    <li><a href="tech.html" class="nav__link">‚ö° –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</a></li>
                    <li><a href="style.html" class="nav__link">üëî –°—Ç–∏–ª—å</a></li>
                    <li><a href="relations.html" class="nav__link">üíë –û—Ç–Ω–æ—à–µ–Ω–∏—è</a></li>
                    <li><a href="forum.html" class="nav__link">üí¨ –§–æ—Ä—É–º</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="main-container">
        <div class="container" style="max-width: 1200px;">
            <!-- Check if user is logged in -->
            <div id="notLoggedIn" style="text-align: center; padding: 60px 20px;">
                <h2 style="font-size: 24px; margin-bottom: 16px;">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç</h2>
                <p style="color: #666; margin-bottom: 20px;">–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–æ—Ñ–∏–ª—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∞–≤—Ç–æ—Ä–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è</p>
                <button id="loginBtn" style="background: #4a9eff; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-weight: 600;">–í–æ–π—Ç–∏</button>
            </div>

            <!-- Profile Content -->
            <div id="profileContent" style="display: none;">
                <!-- Profile Header -->
                <div class="profile-header">
                    <div class="profile-avatar">
                        <div class="avatar-circle" id="profileAvatar">üë§</div>
                    </div>
                    <div class="profile-info">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h1 id="profileName">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h1>
                            <button id="editProfileBtn" style="background: #4a9eff; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-weight: 600; font-size: 14px;">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                        </div>
                        <p id="profileEmail" style="color: #666; font-size: 14px; margin-bottom: 16px;">email@example.com</p>
                        <p id="profileBio" style="color: #777; font-size: 14px; margin-bottom: 16px; font-style: italic;"></p>
                        <div class="profile-stats">
                            <div class="stat-card">
                                <div class="stat-card__number" id="articlesCount">0</div>
                                <div class="stat-card__label">–°—Ç–∞—Ç–µ–π –Ω–∞–ø–∏—Å–∞–Ω–æ</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-card__number" id="postsCount">0</div>
                                <div class="stat-card__label">–ü–æ—Å—Ç–æ–≤ –Ω–∞ —Ñ–æ—Ä—É–º–µ</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-card__number" id="subscribersCount">0</div>
                                <div class="stat-card__label">–ü–æ–¥–ø–∏—Å—á–∏–∫–∏</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-card__number" id="followingCount">0</div>
                                <div class="stat-card__label">–ü–æ–¥–ø–∏—Å–æ–∫</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- User's Articles -->
                <div class="profile-section">
                    <h2 class="profile-section__title">üìù –ú–æ–∏ —Å—Ç–∞—Ç—å–∏</h2>
                    <div id="userArticles" class="section-content">
                        <!-- –°—Ç–∞—Ç—å–∏ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                    <div id="noArticles" class="empty-state">
                        <div class="empty-state__icon">üì≠</div>
                        <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å—Ç–∞—Ç–µ–π. <a href="health.html" style="color: #4a9eff;">–ù–∞—á–Ω–∏—Ç–µ –ø–∏—Å–∞—Ç—å</a></p>
                    </div>
                </div>

                <!-- User's Forum Posts -->
                <div class="profile-section">
                    <h2 class="profile-section__title">üí¨ –ú–æ–∏ –ø–æ—Å—Ç—ã –Ω–∞ —Ñ–æ—Ä—É–º–µ</h2>
                    <div id="userPosts" class="section-content">
                        <!-- –ü–æ—Å—Ç—ã –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                    <div id="noPosts" class="empty-state">
                        <div class="empty-state__icon">üí≠</div>
                        <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ—Å—Ç–æ–≤. <a href="forum.html" style="color: #4a9eff;">–£—á–∞—Å—Ç–≤—É–π—Ç–µ –≤ –æ–±—Å—É–∂–¥–µ–Ω–∏—è—Ö</a></p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer__container">
            <div class="footer__content">
                <div class="footer__section">
                    <h4>–û —Å–∞–π—Ç–µ</h4>
                    <ul>
                        <li><a href="about.html">–û Man.ru</a></li>
                        <li><a href="advertise.html">–†–µ–∫–ª–∞–º–∞</a></li>
                        <li><a href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
                        <li><a href="career.html">–í–∞–∫–∞–Ω—Å–∏–∏</a></li>
                    </ul>
                </div>
                <div class="footer__section">
                    <h4>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                    <ul>
                        <li><a href="terms.html">–°–æ–≥–ª–∞—à–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</a></li>
                        <li><a href="privacy.html">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a></li>
                        <li><a href="terms.html">–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö</a></li>
                        <li><a href="sitemap.html">–ö–∞—Ä—Ç–∞ —Å–∞–π—Ç–∞</a></li>
                    </ul>
                </div>
                <div class="footer__section">
                    <h4>–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏</h4>
                    <ul>
                        <li><a href="#">Facebook</a></li>
                        <li><a href="#">Instagram</a></li>
                        <li><a href="#">Twitter</a></li>
                        <li><a href="#">Telegram</a></li>
                    </ul>
                </div>
                <div class="footer__section">
                    <h4>–ü–æ–ø—É–ª—è—Ä–Ω–æ–µ</h4>
                    <ul>
                        <li><a href="#">–í—Å–µ —Å—Ç–∞—Ç—å–∏</a></li>
                        <li><a href="#">–§–æ—Ä—É–º</a></li>
                        <li><a href="#">–ù–æ–≤–æ—Å—Ç–∏</a></li>
                        <li><a href="#">–¢–æ–ø –∞–≤—Ç–æ—Ä–æ–≤</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer__bottom">
                <p>&copy; 2026 Man.ru. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
            </div>
        </div>
    </footer>

    <script src="auth-script.js"></script>
    <script>
        // Profile Page Logic
        class ProfileManager {
            constructor() {
                this.usersKey = 'man_ru_users';
                this.articlesKey = 'man_ru_articles';
                this.forumPostsKey = 'man_ru_forum_posts';
                this.currentUserKey = 'man_ru_current_user';
                this.init();
            }

            init() {
                this.checkUserLogin();
                // loadProfileData –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–∏–Ω–∞ –≤–Ω—É—Ç—Ä–∏ checkUserLogin
            }

            checkUserLogin() {
                const currentUser = JSON.parse(localStorage.getItem(this.currentUserKey));
                const loginBtn = document.getElementById('loginBtn');

                if (!currentUser) {
                    document.getElementById('profileContent').style.display = 'none';
                    document.getElementById('notLoggedIn').style.display = 'block';
                    
                    if (loginBtn) {
                        loginBtn.addEventListener('click', () => {
                            // –ï—Å–ª–∏ AuthManager –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ modal
                            if (window.authManager) {
                                document.getElementById('authModal').classList.add('active');
                                document.body.style.overflow = 'hidden';
                            } else {
                                // –ò–Ω–∞—á–µ –ø—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ modal –≤—Ä—É—á–Ω—É—é
                                let authModal = document.getElementById('authModal');
                                if (!authModal) {
                                    // –°–æ–∑–¥–∞—ë–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π modal —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º
                                    authModal = document.createElement('div');
                                    authModal.id = 'authModal';
                                    authModal.innerHTML = '<p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É</p>';
                                    document.body.appendChild(authModal);
                                }
                                if (authModal) {
                                    authModal.classList.add('active');
                                    document.body.style.overflow = 'hidden';
                                }
                            }
                        });
                    }
                } else {
                    document.getElementById('profileContent').style.display = 'block';
                    document.getElementById('notLoggedIn').style.display = 'none';
                    this.displayUserInfo(currentUser);
                    this.loadProfileData();
                }
            }

            displayUserInfo(user) {
                document.getElementById('profileName').textContent = user.name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                document.getElementById('profileEmail').textContent = user.email;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º joinDate —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
                const joinDateElement = document.getElementById('joinDate');
                if (joinDateElement) {
                    joinDateElement.textContent = user.registrationDate || new Date().toLocaleDateString('ru-RU');
                }
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const users = JSON.parse(localStorage.getItem(this.usersKey)) || [];
                const fullUser = users.find(u => u.email === user.email);
                
                if (fullUser) {
                    const avatarElement = document.getElementById('profileAvatar');
                    if (avatarElement && fullUser.avatar) {
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —ç—Ç–æ –ª–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∞ (Data URL) –∏–ª–∏ —ç–º–æ–¥–∑–∏
                        if (fullUser.avatar.startsWith('data:')) {
                            // –≠—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ - –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –∫–∞–∫ img
                            avatarElement.style.fontSize = 'inherit';
                            avatarElement.style.padding = '0';
                            avatarElement.innerHTML = `<img src="${fullUser.avatar}" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover; display: block;">`;
                        } else {
                            // –≠—Ç–æ —ç–º–æ–¥–∑–∏ –∏–ª–∏ —Ç–µ–∫—Å—Ç
                            avatarElement.innerHTML = fullUser.avatar;
                            avatarElement.style.fontSize = '60px';
                            avatarElement.style.padding = '';
                        }
                    }
                    if (fullUser.bio) {
                        document.getElementById('profileBio').textContent = fullUser.bio;
                    }
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–¥–æ–±–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑)
                const editBtn = document.getElementById('editProfileBtn');
                if (editBtn && !editBtn.hasEventListener) {
                    editBtn.addEventListener('click', () => this.openEditProfileModal(user));
                    editBtn.hasEventListener = true;
                }
            }

            loadProfileData() {
                const currentUser = JSON.parse(localStorage.getItem(this.currentUserKey));
                if (!currentUser) return;

                const articles = JSON.parse(localStorage.getItem(this.articlesKey)) || [];
                const posts = JSON.parse(localStorage.getItem(this.forumPostsKey)) || [];
                const users = JSON.parse(localStorage.getItem(this.usersKey)) || [];

                // –¢–∞–∫–∂–µ –∏—â–µ–º –ø–æ –∏–º–µ–Ω–∏, –µ—Å–ª–∏ authorEmail –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
                const userArticles = articles.filter(a => 
                    a.authorEmail === currentUser.email || a.author === currentUser.name
                );
                const userPosts = posts.filter(p => 
                    p.authorEmail === currentUser.email || p.author === currentUser.name
                );
                
                // Get subscriber and following counts
                const userData = users.find(u => u.email === currentUser.email);
                const subscribersCount = userData?.followers ? userData.followers.length : 0;
                const followingCount = userData?.following ? userData.following.length : 0;

                document.getElementById('articlesCount').textContent = userArticles.length;
                document.getElementById('postsCount').textContent = userPosts.length;
                document.getElementById('subscribersCount').textContent = subscribersCount;
                document.getElementById('followingCount').textContent = followingCount;

                this.displayArticles(userArticles);
                this.displayPosts(userPosts);
                }       

            displayArticles(articles) {
                const container = document.getElementById('userArticles');
                const noArticles = document.getElementById('noArticles');
                const currentUser = JSON.parse(localStorage.getItem(this.currentUserKey));
                const users = JSON.parse(localStorage.getItem(this.usersKey)) || [];

                if (articles.length === 0) {
                    container.style.display = 'none';
                    noArticles.style.display = 'block';
                    return;
                }

                noArticles.style.display = 'none';
                container.innerHTML = articles.map(article => {
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —ç—Ç–æ —Å—Ç–∞—Ç—å—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    const isOwnArticle = currentUser && (article.authorEmail === currentUser.email || article.author === currentUser.name);
                    const deleteButton = isOwnArticle ? 
                        `<button class="btn-delete" onclick="profileManager.deleteArticle(${article.id})">–£–¥–∞–ª–∏—Ç—å</button>` : 
                        '';
                    
                    // –ü–æ–ª—É—á–∞–µ–º –∞–≤–∞—Ç–∞—Ä–∫—É –∞–≤—Ç–æ—Ä–∞ –ø–æ email, –µ—Å–ª–∏ –Ω–µ—Ç - –ø–æ –∏–º–µ–Ω–∏
                    let author = users.find(u => u.email === article.authorEmail);
                    if (!author) {
                        author = users.find(u => u.name === article.author);
                    }
                    
                    const authorId = author ? author.id : null;
                    const avatar = author ? author.avatar : 'üë§';
                    let avatarHTML = avatar;
                    if (avatar && avatar.startsWith('data:')) {
                        avatarHTML = `<img src="${avatar}" style="width: 24px; height: 24px; border-radius: 50%; object-fit: cover;">`;
                    } else {
                        avatarHTML = `<span style="font-size: 18px;">${avatar}</span>`;
                    }
                    
                    // –°–æ–∑–¥–∞—ë–º –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –∞–≤—Ç–æ—Ä–∞
                    const authorLink = authorId ? 
                        `<a href="view-profile.html?id=${authorId}" style="cursor: pointer; color: #4a9eff; text-decoration: underline; display: flex; align-items: center; gap: 4px; transition: all 0.2s;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">${avatarHTML} ${article.author}</a>` :
                        `<span style="display: flex; align-items: center; gap: 4px;">${avatarHTML} ${article.author}</span>`;
                    
                    return `
                    <div class="content-item">
                        <div class="content-item__category">${article.category}</div>
                        <div class="content-item__title">${article.title}</div>
                        <p style="font-size: 12px; color: #666; margin: 8px 0;">${article.description}</p>
                        <div class="content-item__meta">
                            <span>${article.date}</span>
                            ${authorLink}
                            ${deleteButton}
                        </div>
                    </div>
                `;
                }).join('');
            }

            displayPosts(posts) {
                const container = document.getElementById('userPosts');
                const noPosts = document.getElementById('noPosts');
                const currentUser = JSON.parse(localStorage.getItem(this.currentUserKey));
                const users = JSON.parse(localStorage.getItem(this.usersKey)) || [];

                if (posts.length === 0) {
                    container.style.display = 'none';
                    noPosts.style.display = 'block';
                    return;
                }

                noPosts.style.display = 'none';
                container.innerHTML = posts.map(post => {
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —ç—Ç–æ –ø–æ—Å—Ç —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    const isOwnPost = currentUser && (post.authorEmail === currentUser.email || post.author === currentUser.name);
                    const deleteButton = isOwnPost ? 
                        `<button class="btn-delete" onclick="profileManager.deletePost(${post.id})">–£–¥–∞–ª–∏—Ç—å</button>` : 
                        '';
                    
                    // –ü–æ–ª—É—á–∞–µ–º –∞–≤–∞—Ç–∞—Ä–∫—É –∞–≤—Ç–æ—Ä–∞ –ø–æ email, –µ—Å–ª–∏ –Ω–µ—Ç - –ø–æ –∏–º–µ–Ω–∏
                    let author = users.find(u => u.email === post.authorEmail);
                    if (!author) {
                        author = users.find(u => u.name === post.author);
                    }
                    
                    const authorId = author ? author.id : null;
                    const avatar = author ? author.avatar : 'üë§';
                    let avatarHTML = avatar;
                    if (avatar && avatar.startsWith('data:')) {
                        avatarHTML = `<img src="${avatar}" style="width: 24px; height: 24px; border-radius: 50%; object-fit: cover;">`;
                    } else {
                        avatarHTML = `<span style="font-size: 18px;">${avatar}</span>`;
                    }
                    
                    // –°–æ–∑–¥–∞—ë–º –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –∞–≤—Ç–æ—Ä–∞
                    const authorLink = authorId ? 
                        `<a href="view-profile.html?id=${authorId}" style="cursor: pointer; color: #4a9eff; text-decoration: underline; display: flex; align-items: center; gap: 4px; transition: all 0.2s;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">${avatarHTML} ${post.author}</a>` :
                        `<span style="display: flex; align-items: center; gap: 4px;">${avatarHTML} ${post.author}</span>`;
                    
                    return `
                    <div class="content-item">
                        <div class="content-item__category">–§–æ—Ä—É–º</div>
                        <div class="content-item__title">${post.title}</div>
                        <p style="font-size: 12px; color: #666; margin: 8px 0;">${post.message}</p>
                        <div class="content-item__meta">
                            <span>${post.date}</span>
                            ${authorLink}
                            ${deleteButton}
                        </div>
                    </div>
                `;
                }).join('');
            }

            deleteArticle(id) {
                const currentUser = JSON.parse(localStorage.getItem(this.currentUserKey));
                const articles = JSON.parse(localStorage.getItem(this.articlesKey)) || [];
                const article = articles.find(a => a.id === id);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å - –∞–≤—Ç–æ—Ä —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏
                if (!currentUser || !article || (article.authorEmail !== currentUser.email && article.author !== currentUser.name)) {
                    alert('‚ùå –í—ã –º–æ–∂–µ—Ç–µ —É–¥–∞–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —Å—Ç–∞—Ç—å–∏');
                    return;
                }
                
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —Å—Ç–∞—Ç—å—é?')) {
                    let updatedArticles = JSON.parse(localStorage.getItem(this.articlesKey)) || [];
                    updatedArticles = updatedArticles.filter(a => a.id !== id);
                    localStorage.setItem(this.articlesKey, JSON.stringify(updatedArticles));
                    this.loadProfileData();
                    alert('‚úÖ –°—Ç–∞—Ç—å—è —É–¥–∞–ª–µ–Ω–∞');
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
                    if (window.indexPageManager) {
                        window.indexPageManager.updateSiteStats();
                    }
                }
            }

            deletePost(id) {
                const currentUser = JSON.parse(localStorage.getItem(this.currentUserKey));
                const posts = JSON.parse(localStorage.getItem(this.forumPostsKey)) || [];
                const post = posts.find(p => p.id === id);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å - –∞–≤—Ç–æ—Ä —ç—Ç–æ–≥–æ –ø–æ—Å—Ç–∞
                if (!currentUser || !post || (post.authorEmail !== currentUser.email && post.author !== currentUser.name)) {
                    alert('‚ùå –í—ã –º–æ–∂–µ—Ç–µ —É–¥–∞–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –ø–æ—Å—Ç—ã');
                    return;
                }
                
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø–æ—Å—Ç?')) {
                    let updatedPosts = JSON.parse(localStorage.getItem(this.forumPostsKey)) || [];
                    updatedPosts = updatedPosts.filter(p => p.id !== id);
                    localStorage.setItem(this.forumPostsKey, JSON.stringify(updatedPosts));
                    this.loadProfileData();
                    alert('‚úÖ –ü–æ—Å—Ç —É–¥–∞–ª—ë–Ω');
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
                    if (window.indexPageManager) {
                        window.indexPageManager.updateSiteStats();
                    }
                }
            }

            openEditProfileModal(currentUser) {
                const users = JSON.parse(localStorage.getItem(this.usersKey)) || [];
                const fullUser = users.find(u => u.email === currentUser.email);
                const self = this; // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ this –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö
                const modalHTML = `
                    <div id="editProfileModal" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; z-index: 10000;">
                        <div style="background: white; padding: 30px; border-radius: 8px; max-width: 500px; width: 90%; max-height: 90vh; overflow-y: auto;">
                            <h2 style="margin-bottom: 20px;">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</h2>
                            
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">–ê–≤–∞—Ç–∞—Ä–∫–∞ (—Ñ–æ—Ç–æ –∏–ª–∏ —ç–º–æ–¥–∑–∏)</label>
                                <div style="display: flex; gap: 10px; align-items: center; margin-bottom: 10px;">
                                    <div id="avatarPreview" style="font-size: 40px; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; background: #f0f0f0; border-radius: 4px; overflow: hidden;">
                                        ${fullUser?.avatar && fullUser.avatar.startsWith('data:') ? 
                                            `<img src="${fullUser.avatar}" style="width: 100%; height: 100%; object-fit: cover;">` :
                                            fullUser?.avatar || 'üë§'
                                        }
                                    </div>
                                    <input type="file" id="editAvatarFile" accept="image/*" style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                                </div>
                                <small style="display: block; margin-bottom: 8px; color: #999; font-size: 12px;">üì∏ –§–æ—Ä–º–∞—Ç—ã: JPG, PNG. –†–∞–∑–º–µ—Ä –¥–æ 500KB</small>
                                
                                <small style="display: block; margin-bottom: 5px; color: #666;">–∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —ç–º–æ–¥–∑–∏:</small>
                                <select id="editAvatar" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 16px; margin-bottom: 5px;" ${fullUser?.avatar && fullUser.avatar.startsWith('data:') ? '' : `value="${fullUser?.avatar || 'üë§'}"`}>
                                    <option value="üë§">üë§ –ü—Ä–æ—Ñ–∏–ª—å</option>
                                    <option value="üë®">üë® –ú—É–∂—á–∏–Ω–∞</option>
                                    <option value="üë©">üë© –ñ–µ–Ω—â–∏–Ω–∞</option>
                                    <option value="üßë">üßë –ß–µ–ª–æ–≤–µ–∫</option>
                                    <option value="üòä">üòä –£–ª—ã–±–∫–∞</option>
                                    <option value="üòé">üòé –ö—Ä—É—Ç–æ–π</option>
                                    <option value="ü§î">ü§î –î—É–º–∞—é</option>
                                    <option value="üéÆ">üéÆ –ò–≥—Ä—ã</option>
                                    <option value="‚öΩ">‚öΩ –°–ø–æ—Ä—Ç</option>
                                    <option value="üèãÔ∏è">üèãÔ∏è –§–∏—Ç–Ω–µ—Å</option>
                                    <option value="üé∏">üé∏ –ú—É–∑—ã–∫–∞</option>
                                    <option value="üìö">üìö –ö–Ω–∏–≥–∏</option>
                                    <option value="üíª">üíª –ö–æ–º–ø—å—é—Ç–µ—Ä</option>
                                    <option value="üåç">üåç –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è</option>
                                    <option value="üçï">üçï –ï–¥–∞</option>
                                    <option value="‚òï">‚òï –ö–æ—Ñ–µ</option>
                                    <option value="üê∂">üê∂ –°–æ–±–∞–∫–∞</option>
                                    <option value="üê±">üê± –ö–æ—Ç</option>
                                    <option value="ü¶Å">ü¶Å –õ–µ–≤</option>
                                    <option value="üêº">üêº –ü–∞–Ω–¥–∞</option>
                                    <option value="üå≥">üå≥ –ü—Ä–∏—Ä–æ–¥–∞</option>
                                    <option value="üå∏">üå∏ –¶–≤–µ—Ç–æ–∫</option>
                                    <option value="‚õ∞Ô∏è">‚õ∞Ô∏è –ì–æ—Ä–∞</option>
                                    <option value="üíé">üíé –ê–ª–º–∞–∑</option>
                                    <option value="‚≠ê">‚≠ê –ó–≤–µ–∑–¥–∞</option>
                                    <option value="üî•">üî• –û–≥–æ–Ω—å</option>
                                    <option value="‚ù§Ô∏è">‚ù§Ô∏è –°–µ—Ä–¥—Ü–µ</option>
                                </select>
                                <small style="display: block; margin-top: 5px; color: #999; font-size: 12px;">–∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å–≤–æ—ë —Ñ–æ—Ç–æ</small>
                            </div>
                            
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">–ù–∏–∫–Ω–µ–π–º</label>
                                <input type="text" id="editName" value="${currentUser.name}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;" placeholder="–í–∞—à–µ –∏–º—è">
                            </div>
                            
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
                                <input type="date" id="editBirthDate" value="${fullUser?.birthDate || ''}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <label style="display: block; margin-bottom: 5px; font-weight: 600;">–û —Å–µ–±–µ</label>
                                <textarea id="editBio" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; resize: vertical; min-height: 100px;" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–µ–±–µ...">${fullUser?.bio || ''}</textarea>
                            </div>
                            
                            <div style="display: flex; gap: 10px;">
                                <button id="saveProfileBtn" style="flex: 1; background: #4a9eff; color: white; border: none; padding: 12px; border-radius: 4px; cursor: pointer; font-weight: 600;">‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                                <button onclick="document.getElementById('editProfileModal').remove()" style="flex: 1; background: #ddd; color: #333; border: none; padding: 12px; border-radius: 4px; cursor: pointer; font-weight: 600;">‚ùå –û—Ç–º–µ–Ω–∞</button>
                            </div>
                        </div>
                    </div>
                `;
                
                document.body.insertAdjacentHTML('beforeend', modalHTML);
                
                // –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è Data URL —Ñ–æ—Ç–æ
                let uploadedPhotoDataUrl = null;
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —ç–º–æ–¥–∑–∏
                const emojiSelect = document.getElementById('editAvatar');
                if (emojiSelect) {
                    emojiSelect.addEventListener('change', (e) => {
                        const preview = document.getElementById('avatarPreview');
                        preview.innerHTML = e.target.value;
                        preview.style.fontSize = '40px';
                        uploadedPhotoDataUrl = null; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ —Ñ–æ—Ç–æ
                    });
                }
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ –∞–≤–∞—Ç–∞—Ä–∫–∏
                const fileInput = document.getElementById('editAvatarFile');
                if (fileInput) {
                    fileInput.addEventListener('change', (e) => {
                        const file = e.target.files[0];
                        if (file) {
                            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–¥–æ 500KB)
                            if (file.size > 500 * 1024) {
                                alert('‚ùå –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–≤—ã—à–∞—Ç—å 500KB');
                                return;
                            }
                            
                            const reader = new FileReader();
                            reader.onload = (event) => {
                                uploadedPhotoDataUrl = event.target.result;
                                const preview = document.getElementById('avatarPreview');
                                preview.style.fontSize = 'inherit';
                                preview.innerHTML = `<img src="${uploadedPhotoDataUrl}" style="width: 100%; height: 100%; border-radius: 4px; object-fit: cover;">`;
                            };
                            reader.readAsDataURL(file);
                        }
                    });
                }
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                const saveBtn = document.getElementById('saveProfileBtn');
                if (saveBtn) {
                    saveBtn.addEventListener('click', async () => {
                        try {
                            let avatar = uploadedPhotoDataUrl || document.getElementById('editAvatar').value || 'üë§';
                            const name = document.getElementById('editName').value.trim();
                            const birthDate = document.getElementById('editBirthDate').value || null;
                            const bio = document.getElementById('editBio').value.trim();
                            
                            if (!name) {
                                alert('‚ùå –í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º');
                                return;
                            }
                            
                            console.log('üì§ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä...', { name, bio });
                            
                            // –ò—Å–ø–æ–ª—å–∑—É–µ–º APIClient –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è
                            const api = new APIClient();
                            const result = await api.updateUser(currentUser.id, {
                                name: name,
                                bio: bio,
                                avatar: avatar
                            });
                            
                            console.log('‚úÖ –ü—Ä–æ—Ñ–∏–ª—å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª—ë–Ω:', result);
                            
                            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ localStorage
                            const updatedUser = { ...currentUser, name, bio, avatar };
                            localStorage.setItem('man_ru_current_user', JSON.stringify(updatedUser));
                            
                            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
                            const modal = document.getElementById('editProfileModal');
                            if (modal) {
                                modal.remove();
                            }
                            
                            alert('‚úÖ –ü—Ä–æ—Ñ–∏–ª—å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª—ë–Ω!');
                            
                            // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è
                            self.displayUserInfo(updatedUser);
                            self.loadProfileData();
                            
                        } catch (error) {
                            console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è:', error);
                            alert(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
                        }
                    });
                }
            }

            updateAuthorNameEverywhere(oldName, newName, userEmail) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–º—è –∞–≤—Ç–æ—Ä–∞ –≤–æ –≤—Å–µ—Ö —Å—Ç–∞—Ç—å—è—Ö
                let articles = JSON.parse(localStorage.getItem(this.articlesKey)) || [];
                articles = articles.map(article => {
                    if ((article.authorEmail === userEmail || article.author === oldName) && article.author === oldName) {
                        return { ...article, author: newName, authorEmail: userEmail };
                    }
                    return article;
                });
                localStorage.setItem(this.articlesKey, JSON.stringify(articles));

                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–º—è –∞–≤—Ç–æ—Ä–∞ –≤–æ –≤—Å–µ—Ö –ø–æ—Å—Ç–∞—Ö —Ñ–æ—Ä—É–º–∞
                let posts = JSON.parse(localStorage.getItem(this.forumPostsKey)) || [];
                posts = posts.map(post => {
                    if ((post.authorEmail === userEmail || post.author === oldName) && post.author === oldName) {
                        return { ...post, author: newName, authorEmail: userEmail };
                    }
                    return post;
                });
                localStorage.setItem(this.forumPostsKey, JSON.stringify(posts));

                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–º—è –∞–≤—Ç–æ—Ä–∞ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö –∫ —Å—Ç–∞—Ç—å—è–º
                let comments = JSON.parse(localStorage.getItem('man_ru_article_comments')) || [];
                comments = comments.map(comment => {
                    if ((comment.authorEmail === userEmail || comment.author === oldName) && comment.author === oldName) {
                        return { ...comment, author: newName, authorEmail: userEmail };
                    }
                    return comment;
                });
                localStorage.setItem('man_ru_article_comments', JSON.stringify(comments));

                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–º—è –∞–≤—Ç–æ—Ä–∞ –≤ –æ—Ç–≤–µ—Ç–∞—Ö –Ω–∞ –ø–æ—Å—Ç—ã —Ñ–æ—Ä—É–º–∞
                let replies = JSON.parse(localStorage.getItem('man_ru_forum_replies')) || [];
                replies = replies.map(reply => {
                    if ((reply.authorEmail === userEmail || reply.author === oldName) && reply.author === oldName) {
                        return { ...reply, author: newName, authorEmail: userEmail };
                    }
                    return reply;
                });
                localStorage.setItem('man_ru_forum_replies', JSON.stringify(replies));
            }
        }

        const profileManager = new ProfileManager();
        
        // –ü–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ DOM
        document.addEventListener('DOMContentLoaded', () => {
            profileManager.checkUserLogin();
            profileManager.loadProfileData();
        });
    </script>
    
    <!-- Auth Modal -->
    <div class="modal" id="authModal">
        <div class="modal__overlay"></div>
        <div class="modal__content" style="max-width: 500px;">
            <div class="modal__header">
                <h2>–í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
                <button id="closeAuthBtn" class="modal__close-btn">&times;</button>
            </div>
            
            <div class="auth-tabs">
                <button id="loginTab" class="auth-tab active">üîê –í—Ö–æ–¥</button>
                <button id="registerTab" class="auth-tab">‚úçÔ∏è –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>

            <!-- Login Form -->
            <form id="loginForm" class="forum-form">
                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" placeholder="your@email.com" required>
                </div>
                
                <div class="form-group">
                    <label for="loginPassword">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="loginPassword" placeholder="–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤" required>
                </div>
                
                <button type="button" id="loginSubmit" class="btn btn--primary" style="width: 100%;">–í–æ–π—Ç–∏</button>
            </form>

            <!-- Register Form -->
            <form id="registerForm" class="forum-form" style="display: none;">
                <div class="form-group">
                    <label for="registerName">–ò–º—è</label>
                    <input type="text" id="registerName" placeholder="–í–∞—à–µ –∏–º—è" required>
                </div>
                
                <div class="form-group">
                    <label for="registerEmail">Email</label>
                    <input type="email" id="registerEmail" placeholder="your@email.com" required>
                </div>
                
                <div class="form-group">
                    <label for="registerPassword">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="registerPassword" placeholder="–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤" required>
                </div>
                
                <div class="form-group">
                    <label for="registerPasswordConfirm">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–∞—Ä–æ–ª—å</label>
                    <input type="password" id="registerPasswordConfirm" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                </div>
                
                <button type="button" id="registerSubmit" class="btn btn--primary" style="width: 100%;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            </form>
        </div>
    </div>

    <!-- User Menu (for logged in users) -->
    <div id="userMenu" style="display: none; position: absolute; top: 60px; right: 20px; background: white; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); z-index: 999;">
        <a href="profile.html" style="display: block; padding: 12px 20px; text-decoration: none; color: #333; border-bottom: 1px solid #eee;">üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</a>
        <button id="logoutBtn" style="width: 100%; padding: 12px 20px; background: none; border: none; color: #ef4444; cursor: pointer; text-align: left; font-weight: 600;">üö™ –í—ã—Ö–æ–¥</button>
    </div>
    
    <script src="api-client.js"></script>
    <script src="auth-script-api.js"></script>
    <script src="search-dropdown.js"></script>
</body>
</html>
